<!DOCTYPE html>
<html lang="es">
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title class="titulo">Comercio 1</title>
  <style>
    /* Estilos opcionales para mejorar la apariencia */
    body {
        background-image: url("/img/fondo1.jpg");
      font-family: Arial, sans-serif;
      margin: 20px;
      display: flex;
      flex-direction: column;
    }
    .producto {
      margin-bottom: 20px;
    }
    .producto img {
      max-width: 100px;
      margin-right: 10px;
      vertical-align: middle;
    }
    .cantidad {
      width: 50px;
    }
    button {
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
    .btn_color{
        background-color: lightblue;
    }
    .form{
        display: flex;
        flex-direction: column;
    }
  </style>
</head>
<body>
  <h1 class="text-center">Comercio 1</h1>

  <div class="producto">
    <img src="/img/pizza.jpg" alt="Pizza Muzzarella">
    <span>Pizza Muzzarella - $10000</span>
    <input type="number" class="cantidad" id="cantidad1" value="0" min="0">
  </div>

  <div class="producto">
    <img src="/img/pizza-jamon-sobre-mesa_140725-5400.avif" alt="Pizza Jamón y Queso">
    <span>Pizza Jamón y Queso - $12000</span>
    <input type="number" class="cantidad" id="cantidad2" value="0" min="0">
  </div>

  <div class="producto">
    <img src="/img/pizza-de-jamon-y-morrones.jpg" alt="Pizza Jamón y Morrones">
    <span>Pizza Jamón y Morrones - $12000</span>
    <input type="number" class="cantidad" id="cantidad3" value="0" min="0">
  </div>

  <div class="producto">
    <img src="/img/empanada de carne.avif" alt="Empanadas de Carne">
    <span>Empanadas de Carne - $2500</span>
    <input type="number" class="cantidad" id="cantidad4" value="0" min="0">
  </div>

  <div class="producto">
    <img src="/img/empanada jamon y queso.jpg" alt="Empanadas Jamón y Queso">
    <span>Empanadas Jamón y Queso - $2500</span>
    <input type="number" class="cantidad" id="cantidad5" value="0" min="0">
  </div>
  <div class="form" id="formulario">
    <h3>Completa tus datos antes de enviar el pedido:</h3>
    <label for="nombre">Nombre</label>
    <input type="text" id="nombre" required>
  
    <label for="apellido">Apellido:</label>
    <input type="text" id="apellido" required>
  
    <label for="calle">Calle:</label>
    <input type="text" id="calle" required>
  
    <label for="numero">Número:</label>
    <input type="text" id="numero" required>
  
    <label for="entreCalles">Entre Calles:</label>
    <input type="text" id="entreCalles" required>
  
    <label for="telefono">Teléfono:</label>
    <input type="tel" id="telefono" required>
  </div>
  

  <button onclick="enviarPedido()">Enviar Pedido por WhatsApp</button>
  <button class="btn_color" onclick="generarLinkPago()">Pagar con Mercado Pago</button>

  <script>

function enviarPedido() {
  var nombre = document.getElementById('nombre').value;
  var apellido = document.getElementById('apellido').value;
  var calle = document.getElementById('calle').value;
  var numero = document.getElementById('numero').value;
  var entreCalles = document.getElementById('entreCalles').value;
  var telefono = document.getElementById('telefono').value;

  // Construir el mensaje con los datos del formulario y los productos seleccionados
  var mensaje = `Pedido desde la tienda virtual - ${nombre} ${apellido}:\n`;
  mensaje += `Dirección: ${calle} ${numero}, entre ${entreCalles}\n`;
  // Agregar el detalle de los productos seleccionados aquí...

  // Resto del código para construir el mensaje con los productos seleccionados

  var url = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje)}`;
  window.open(url);
}

    function enviarPedido() {
      var cantidad1 = parseInt(document.getElementById('cantidad1').value);
      var cantidad2 = parseInt(document.getElementById('cantidad2').value);
      var cantidad3 = parseInt(document.getElementById('cantidad3').value);
      var cantidad4 = parseInt(document.getElementById('cantidad4').value);
      var cantidad5 = parseInt(document.getElementById('cantidad5').value);

      var precio1 = cantidad1 * 10000;
      var precio2 = cantidad2 * 12000;
      var precio3 = cantidad3 * 12000;
      var precio4 = cantidad4 * 2500;
      var precio5 = cantidad5 * 2500;

      var total = precio1 + precio2 + precio3 + precio4 + precio5;

      var mensaje = `Pedido desde la tienda virtual:\n`;

      if (cantidad1 > 0) {
        mensaje += `${cantidad1} x Pizza Muzzarella - $${precio1}\n`;
      }
      if (cantidad2 > 0) {
        mensaje += `${cantidad2} x Pizza Jamón y Queso - $${precio2}\n`;
      }
      if (cantidad3 > 0) {
        mensaje += `${cantidad3} x Pizza Jamón y Morrones - $${precio3}\n`;
      }
      if (cantidad4 > 0) {
        mensaje += `${cantidad4} x Empanadas de Carne - $${precio4}\n`;
      }
      if (cantidad5 > 0) {
        mensaje += `${cantidad5} x Empanadas Jamón y Queso - $${precio5}\n`;
      }

      mensaje += `\nTotal: $${total}`;

      var telefono = '5492944651381';
      var url = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje)}`;

      window.open(url);
    }

    function generarLinkPago() {
      var cantidad1 = parseInt(document.getElementById('cantidad1').value);
      var cantidad2 = parseInt(document.getElementById('cantidad2').value);
      var cantidad3 = parseInt(document.getElementById('cantidad3').value);
      var cantidad4 = parseInt(document.getElementById('cantidad4').value);
      var cantidad5 = parseInt(document.getElementById('cantidad5').value);

      var precio1 = cantidad1 * 10000;
      var precio2 = cantidad2 * 12000;
      var precio3 = cantidad3 * 12000;
      var precio4 = cantidad4 * 2500;
      var precio5 = cantidad5 * 2500;

      var total = precio1 + precio2 + precio3 + precio4 + precio5;

      // Construir URL del enlace de pago de Mercado Pago
      var mercadoPagoUrl = 'https://www.mercadopago.com.ar/checkout/v1/redirect';
      var preferenceData = {
        external_reference: 'oscarnicolasstella',
        items: [
          {
            title: 'Pizza Muzzarella',
            unit_price: 10000,
            quantity: cantidad1
          },
          {
            title: 'Pizza Jamón y Queso',
            unit_price: 12000,
            quantity: cantidad2
          },
          {
            title: 'Pizza Jamón y Morrones',
            unit_price: 12000,
            quantity: cantidad3
          },
          {
            title: 'Empanadas de Carne',
            unit_price: 2500,
            quantity: cantidad4
          },
          {
            title: 'Empanadas Jamón y Queso',
            unit_price: 2500,
            quantity: cantidad5
          }
        ]
      };

      // Realizar la solicitud POST a Mercado Pago para obtener la preferencia
      fetch('https://api.mercadopago.com/checkout/preferences', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer YOUR_ACCESS_TOKEN' // Reemplaza YOUR_ACCESS_TOKEN con tu access token de Mercado Pago
        },
        body: JSON.stringify(preferenceData)
      })
      .then(response => response.json())
      .then(data => {
        var preferenceId = data.id;
        var urlPago = `${mercadoPagoUrl}?pref_id=${preferenceId}`;
        window.open(urlPago);
      })
      .catch(error => {
        console.error('Error al generar enlace de pago:', error);
        alert('Error al generar enlace de pago. Por favor, intenta nuevamente más tarde.');
      });
    }
    
  </script>
</body>
</html>